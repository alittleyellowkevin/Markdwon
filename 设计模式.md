# 设计模式

### 设计模式的概念：

**设计模式**是对软件设计中普遍存在（反复出现）的各种问题，所提出的解决方案。

**优点**：可扩展性，可读性，规范性，以及高内聚，低耦合。 

**面试**：使用过什么设计模式，怎么使用的，解决了什么问题？

### 设计模式的七大原则：

1. 单一职责原则：一个类只负责一项职责，当类中方法数量足够少，可以在方法级别保持单一职责。
2. 接口隔离原则：客户端不应该依赖它不需要的接口，即一个类对另一个类的依赖应该建立在最小的接口上
3. 依赖倒转原则：细节依赖抽象， 面向接口编程，变量的声明类型尽量是抽象类或接口  
4. 里氏替换原则：子类中尽量不要重写父类的方法，可以采用聚合，组合，依赖来解决问题
5. 开闭原则（**OCP**）：一个类，模块和函数都应该对扩展开放，对修改关闭。用抽象构造框架，用实现扩展细节。当软件需要改变，尽量通过扩展软件实体来实现变化，而不是通过修改已有的代码来改变
6. 迪米特法则：一个对象应该对其他对象保持最少的了解，对于被依赖的类，尽量将逻辑封装在类的内部。 陌生的类尽量不要以局部变量的形式出现在类的内部，核心是降低耦合
7. 合成复用原则：尽量使用合成/聚合的方式，而不是使用继承

#### UML基本介绍

依赖关系：只要类中使用到了对方就存在依赖关系，如类中用到了其他类，类的成员变量，方法的返回类型等

聚合关系：表示的是整体和部分的关系，整体与部分可以分开

组合关系：如果整体和部分不能分开，则是组合关系

### 设计模式的类型

1. 创建型模式：单例模式，抽象工厂模式，原型模式，建造者模式，方法工厂模式
2. 结构性模式：适配器模式，桥接模式，装饰模式，组合模式，外观模式，享元模式，代理模式
3. 行为型模式：模板方法模式，命令模式，访问者模式，迭代器模式，观察者模式，中介者模式，备忘录模式，解释器模式，状态模式，策略模式，职责链模式

#### 单例模式 

**概念**：所谓单例设计模式，就是采取一定方法保证整个软件系统中， 对某个类只能存在一个对象实例，并且该类只提供一个获取其对象实例的方法

**应用场景**：例如SessionFactory，用于负责创建Session对象，Runtime是饿汉模式

1. 饿汉式：简单，但是会造成内存浪费
2. 懒汉式：不会内存浪费，但是容易只能用在单线程，多线程方式又影响运行效率
3. 双重检查：推荐使用

#### 简单工厂模式

**概念**：简单工厂包括抽象产品，具体产品，具体工厂 

![](https://gulinall-hkw.oss-cn-shenzhen.aliyuncs.com/d5fedc60-e710-4552-9c6a-8ade4ee1875c.png)

**应用场景：** Calendar类，根据不同时区来获取不同的Calendar对象

**作用**：将实例化对象提取出来，放到一个类中统一管理和维护，达到和主项目的依赖关系解耦

#### 工厂方法模式

**概念：**主要包括抽象工厂，具体工厂，抽象产品，具体产品 

![](https://gulinall-hkw.oss-cn-shenzhen.aliyuncs.com/d2a3d025-7fbd-433c-a8ab-af4d5252ea86.png)

#### 抽象工厂模式

**概念：**抽象工厂是工厂方法模式的升级版本，工厂方法只生产一个等级的产品，而抽象工厂可生产多个等级的产品

![](https://gulinall-hkw.oss-cn-shenzhen.aliyuncs.com/1082f89b-c0dc-4e27-8dbf-aea3f86d014e.png)

 #### 原型模式

**概念**：用原型实例制定创建对象的种类，并通过拷贝这些原型，创建新的对象。工作原理是使用clone()方法，深拷贝，浅拷贝

**应用场景:** Spring中xml配置文件，scope = "prototype" 

#### 建造者模式

**概念：**又叫生成器模式，是一种对象构建模式，允许用户只制定复杂对象的类型和内容就行，不需要知道内部的具体构建细节，包含产品角色，抽象建造者，具体建造者，指挥者![](https://gulinall-hkw.oss-cn-shenzhen.aliyuncs.com/22038356-fee2-403d-95f9-3f1af26c3214.png)

**应用场景**： StringBuilder，比如字符串是我们的产品，然后我们利用builder的一些方法实现字符串的变化，最后得到我们所要的字符串

#### 适配器模式

**概念**：将某个类的接口转换成客户端期望的另一个接口表示，主要目的是兼容性 ，让原本接口不匹配的两个类可以协同工作

**类型：**类适配器，对象适配器，接口适配器

